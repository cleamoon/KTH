clc
clear
L1=2000;
L3=1500;
L2=sqrt(L1^2+L3^2);

A=500;
E=210000;
K1=[A*E/L1 -A*E/L1
    -A*E/L1 A*E/L1];
K2=[A*E/L2 -A*E/L2
    -A*E/L2 A*E/L2];
K3=[A*E/L3 -A*E/L3
    -A*E/L3 A*E/L3];
a1=0; a2=(143.1*0.0174532925); a3=(-90*0.0174532925);
T1=[cos(a1) sin(a1) 0 0
    0 0 cos(a1) sin(a1)];
T2=[cos(a2) sin(a2) 0 0
    0 0 cos(a2) sin(a2)];
T3=[cos(a3) sin(a3) 0 0
    0 0 cos(a3) sin(a3)];
K1G=T1'*K1*T1;
K2G=T2'*K2*T2;
K3G=T3'*K3*T3;
KG=[K1G(1,1)+K3G(1,1) K1G(1,2)+K3G(1,2) K1G(1,3) K1G(1,4) K3G(1,3) K3G(1,4)
    K1G(2,1)+K3G(2,1) K1G(2,2)+K3G(2,2) K1G(2,3) K1G(2,4) K3G(2,3) K3G(2,4)
    K1G(3,1) K1G(3,2) K1G(3,3)+K2G(1,1) K1G(3,4)+K2G(1,2) K2G(1,3) K2G(1,4)
    K1G(4,1) K1G(4,2) K1G(4,3)+K2G(2,1) K1G(4,4)+K2G(2,2) K2G(2,3) K2G(2,4)
    K3G(3,1) K3G(3,2) K2G(3,1) K2G(3,2) K2G(3,3)+K3G(3,3) K2G(3,4)+K3G(3,4)
    K3G(4,1) K3G(4,2) K2G(4,1) K2G(4,2) K2G(4,3)+K3G(4,3) K2G(4,4)+K3G(4,4)];
Kred=[K1G(3,3)+K2G(1,1) K1G(3,4)+K2G(1,2)
    K1G(4,3)+K2G(2,1) K1G(4,4)+K2G(2,2)]
F=[0 -10000]';
u=Kred^-1*F;
u
